CREATE DATABASE IF NOT EXISTS barangay_db;
USE barangay_db;

-- Login table for authentication
CREATE TABLE IF NOT EXISTS login (
  id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  username VARCHAR(50) NOT NULL COLLATE utf8mb4_unicode_ci,
  password VARCHAR(50) NOT NULL COLLATE utf8mb4_unicode_ci,
  usertype VARCHAR(10) NOT NULL DEFAULT 'user' COLLATE utf8mb4_unicode_ci
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Admin table (legacy, can be removed if using login)
CREATE TABLE IF NOT EXISTS admin (
  id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  Username VARCHAR(50) NOT NULL COLLATE utf8mb4_unicode_ci,
  Password VARCHAR(50) NOT NULL COLLATE utf8mb4_unicode_ci
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- User table
CREATE TABLE IF NOT EXISTS user (
  id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  FirstName VARCHAR(64) NOT NULL COLLATE utf8mb4_unicode_ci,
  LastName VARCHAR(64) NOT NULL COLLATE utf8mb4_unicode_ci,
  Email VARCHAR(64) NOT NULL COLLATE utf8mb4_unicode_ci,
  Username VARCHAR(32) NOT NULL COLLATE utf8mb4_unicode_ci,
  Password VARCHAR(32) NOT NULL COLLATE utf8mb4_unicode_ci,
  Status VARCHAR(50) NOT NULL COLLATE utf8mb4_unicode_ci
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Request table (aligned with BDORS structure)
CREATE TABLE IF NOT EXISTS request (
  Username VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  Fullname VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  Birthdate VARCHAR(20) COLLATE utf8mb4_unicode_ci NOT NULL,
  Age INT(2) NOT NULL,
  Gender VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  HomeAddress VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  Contact VARCHAR(11) COLLATE utf8mb4_unicode_ci NOT NULL,
  DateofRequest VARCHAR(11) COLLATE utf8mb4_unicode_ci NOT NULL,
  Purposes VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  Documents VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  Fee VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  ValidID VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  FrontID LONGTEXT COLLATE utf8mb4_unicode_ci,
  BackID LONGTEXT COLLATE utf8mb4_unicode_ci,
  Payment VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  Service VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  Status VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Requests table (new structure for enhanced system)
CREATE TABLE IF NOT EXISTS requests (
  id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  username VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  reference_number VARCHAR(20) COLLATE utf8mb4_unicode_ci NOT NULL,
  lastname VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  firstname VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  middlename VARCHAR(50) COLLATE utf8mb4_unicode_ci,
  gender VARCHAR(10) COLLATE utf8mb4_unicode_ci NOT NULL,
  age INT(3) NOT NULL,
  residency VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  address VARCHAR(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  contact VARCHAR(15) COLLATE utf8mb4_unicode_ci NOT NULL,
  email VARCHAR(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  id_type VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  document_type VARCHAR(50) COLLATE utf8mb4_unicode_ci NOT NULL,
  purpose VARCHAR(100) COLLATE utf8mb4_unicode_ci NOT NULL,
  status VARCHAR(20) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT 'Pending',
  front_id_path VARCHAR(255) COLLATE utf8mb4_unicode_ci,
  back_id_path VARCHAR(255) COLLATE utf8mb4_unicode_ci,
  Fee VARCHAR(50) COLLATE utf8mb4_unicode_ci DEFAULT '0',
  Payment VARCHAR(50) COLLATE utf8mb4_unicode_ci DEFAULT 'Pending',
  Service VARCHAR(50) COLLATE utf8mb4_unicode_ci DEFAULT 'Pending',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- Insert default admin
INSERT INTO login (username, password, usertype) VALUES ('admin', MD5('admin123'), 'admin') ON DUPLICATE KEY UPDATE id=id;

-- Insert default user
INSERT INTO user (FirstName, LastName, Email, Username, Password, Status) VALUES ('user1', 'user1', 'user1@gmail.com', 'user1', MD5('user1'), 'Active') ON DUPLICATE KEY UPDATE id=id;
